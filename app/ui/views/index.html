<!DOCTYPE html>
<html>
  <head>
    <title>Radiodan Remote Control</title>
    <link rel="stylesheet" href="assets/css/app.css">
  </head>

  <body>
    <script id="mastheadTmpl" data-ui-template type="text/ractive">
    {% raw %}
    {{#radio.power}}
    <p class="lo-left {{ isOn ? 'is-on' : 'is-off' }}">
      <a  on-tap="power"
          href="/power">Turn {{ isOn ? 'Off' : 'On' }}</a>
    </p>
    {{/radio.power}}
    <p class="lo-center">
      <span>Radiodan icon</span>
    </p>
    <p class="lo-right {{ isOn ? 'is-on' : 'is-off' }}">
      <a on-tap="settings-button"
         class="setup-btn">
         <span class="sb-inner">
          setup
        </span>
      </a>
    </p>
    {% endraw %}
    </script>

    <script id="playoutTmpl" data-ui-template type="text/ractive">
    {% raw %}
    <div class="lo-left current-panel">
      <a on-tap="stations-button"
         class="ct-btn">
        {{#radio.current.logos.active}}
          <img class="ct-logo"
               src="{{radio.current.logos.active}}" />
        {{/radio.current.logos.active}}

        <span class="ct-indicator">
          {{ ui.panels.services.isOpen ? '⬇' : '⬆' }}
        </span>

        {{^radio.current}}
          <span class="ct-title">No current station</span>
        {{/radio.current}}
        {{#radio.current}}
          <span class="ct-title">{{title}}</span>
        {{/radio.current}}
      </a>
    </div>

    <div class="lo-right">
      {{ ui.panels.volume.isOpen ? '⬇' : '⬆' }}
      <a on-tap="volume-button">Volume</a>
    </div>
    {% endraw %}
    </script>

    <script id="volumeTmpl" data-ui-template type="text/ractive">
    {% raw %}
    {{#radio.audio}}
    <div class="lo-center">
      <input type="range"
             on-change="volume"
             min="0" max="100" value="{{volume}}" />
    </div>
    {{/radio.audio}}
    {% endraw %}
    </script>

    <script id="metadataTmpl" data-ui-template type="text/ractive">
    {% raw %}
    {{#radio.current}}
      {{#first(nowAndNext)}}
      <div class="metadata">
        {{#image}}
          <img class="md-img"
               src="{{ imageUrl(templateUrl, '272x153') }}" />
        {{/image}}
        <p class="md-primary">{{ brand }}</p>
        <p class="md-secondary">{{ episode }}</p>
      </div>
      {{/nowAndNext}}
      {{#nowPlaying}}
      <div class="metadata">
        <p class="md-primary">{{ title }}</p>
        <p class="md-secondary">{{ artist }}</p>
      </div>
      <a class="track" on-tap="track-display">
        <i></i>
        <span>Track</span>
      </a>
      {{/nowPlaying}}

    {{/radio.current}}
    {% endraw %}
    </script>

    <script id="servicesTmpl" data-ui-template type="text/ractive">
    {% raw %}
    <ul class="service-list">
    {{#services}}
      <li on-tap="services-partial:{{action}}"
          class="service-item {{ isActive(id) ? 'is-active' : '' }}"
          data-action="{{action}}">
        <a  href="/radio/service/{{ id }}">
          <img src="{{ isActive(id) ? logos.active : logos.inactive }}" alt="{{ title }}" />
        </a>
      </li>
    {{/services}}
    </ul>
    {% endraw %}
    </script>

    <script id="progressTempl" data-ui-template type="text/ractive">
    {% raw %}
    <svg width='100%' height='100%' viewBox='0 0 100 100'>
        <!-- Now in here, a coordinate (25,50) corresponds to
             (25%,50%) of the outer viewport. -->
        <g transform="translate(50, 50)">
          <path class="button-circle" d="{{ outerArcPath }}"/>
          <path class="button-progress" fill="red" d="{{ progressArcPath }}"/>
        </g>
      </svg>
    {% endraw %}
    </script>

    <script id="mainTmpl" data-ui-template type="text/ractive">
      {% raw %}
        <section id="masthead" class="layout panel">
          {{>mastheadTmpl}}
        </section>

        {{^ui.panels.settings.isOpen}}
        <section id="playout" class="layout panel">
          {{>playoutTmpl}}
        </section>

        <section id="volume" class="layout panel {{ ui.panels.volume.isOpen ? '' : 'is-closed' }}">
          {{>volumeTmpl}}
        </section>

        <section  id="services"
                  class="layout panel services {{ ui.panels.services.isOpen ? '' : 'is-closed' }}">
          {{>servicesTmpl}}
        </section>

        <section id="metadata" class="layout">
          <div class="lo-single metadata-panel">
            {{>metadataTmpl}}
          </div>
        </section>

        <section id="magic">
          <ul>
            {{#radio.magic}}
              {{#avoider.state}}
              <li class="mg-item avoider {{#isAvoiding}}is-active{{/isAvoiding}}">
                <div>
                  <h2 class="mg-name">
                  {{^isAvoiding}}Avoider{{/isAvoiding}}
                  {{#isAvoiding}}Resume in:{{/isAvoiding}}
                  </h2>

                  <div class="mg-button" on-tap="avoid">
                    {{#ui.magic.avoider}}
                      {{>progressTempl}}
                    {{/ui.magic.avoider}}

                    <div class="mg-label">
                      {{^isAvoiding}}<i class="mg-icon">{{/isAvoiding}}
                      {{#isAvoiding}}<span>{{ timeLeft }}</span>{{/isAvoiding}}
                    </div>
                    </i>
                  </div>
                </div>

                <div on-tap="avoid-settings">
                  {{^isAvoiding}}
                  <div class="settings">
                    <i></i>
                    <span>Avoid settings</span>
                  </div>
                  {{/isAvoiding}}
                </div>
              {{/avoider.state}}
              {{#ui.panels.avoiderSettings.isOpen}}
                {{#avoider}}
                <div class="mg-settings">
                  <h2>What would you like to avoid?</h2>
                  <p>
                    <label>
                      <input type='radio' name='{{settings.avoidType}}' value='tracks'>
                      The current track
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type='radio' name='{{settings.avoidType}}' value='programmes'>
                      The entire programme
                    </label>
                  </p>
                  <h3>Avoid with</h3>
                  {{>servicesTmpl}}
                </div>
                </li>
                {{/avoider}}
              {{/ui.panels.avoiderSettings.isOpen}}
            {{/radio.magic}}
          </ul>
        </section>
        {{/ui.panels.settings.isOpen}}

        {{#ui.panels.settings.isOpen}}
        <section id="settings">
          <h2>Settings</h2>
        </section>
        {{/ui.panels.settings.isOpen}}
      {% endraw %}
    </script>

    <div data-ui-container>
    </div>

    <script src="assets/js/app.{% if isDebug %}debug.{% endif %}js"></script>
  </body>
</html>
