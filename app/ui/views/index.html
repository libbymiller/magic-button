<!DOCTYPE html>
<html>
  <head>
    <title>Radiodan Remote Control</title>
    <link rel="stylesheet" href="assets/css/lib/pure-min.css">
    <link rel="stylesheet" href="assets/css/modules/layout.css">
    <link rel="stylesheet" href="assets/css/modules/panel.css">
    <link rel="stylesheet" href="assets/css/app.css">
  </head>

  <body>
    <script id="mastheadTmpl" data-ui-template type="text/ractive">
    {% raw %}
    {{#radio.power}}
    <p class="lo-left {{ isOn ? 'is-on' : 'is-off' }}">
      <a  on-tap="power"
          href="/power">Turn {{ isOn ? 'Off' : 'On' }}</a>
    </p>
    {{/radio.power}}
    <p class="lo-center">
      <span>Radiodan icon</span>
    </p>
    <p class="lo-right {{ isOn ? 'is-on' : 'is-off' }}">
      <a on-tap="settings-button">setup</a>
    </p>
    {% endraw %}
    </script>

    <script id="playoutTmpl" data-ui-template type="text/ractive">
    {% raw %}
    <div class="lo-left current-panel">
      <a on-tap="stations-button"
         class="ct-btn">
        <span class="ct-indicator">
          {{ ui.panels.services.isOpen ? '⬇' : '⬆' }}
        </span>
        {{#radio.current.logos.active}}
          <img class="ct-logo"
               src="{{radio.current.logos.active}}" />
        {{/radio.current.logos.active}}
        {{^radio.current}}
          <span class="ct-title">No current station</span>
        {{/radio.current}}
        {{#radio.current}}
          <span class="ct-title">{{title}}</span>
        {{/radio.current}}
      </a>
    </div>

    <div class="lo-right">
      {{ ui.panels.volume.isOpen ? '⬇' : '⬆' }}
      <a on-tap="volume-button">Volume</a>
    </div>
    {% endraw %}
    </script>

    <script id="volumeTmpl" data-ui-template type="text/ractive">
    {% raw %}
    {{#radio.audio}}
    <div class="lo-center">
      <input type="range"
             on-change="volume"
             min="0" max="100" value="{{volume}}" />
    </div>
    {{/radio.audio}}
    {% endraw %}
    </script>

    <script id="metadataTmpl" data-ui-template type="text/ractive">
    {% raw %}
    {{#radio.current}}
      {{#first(nowAndNext)}}
      <div class="current-programme">
        <p>{{ brand }}</p>
        <p>{{ episode }}</p>
        {{#image}}
          <img src="{{ imageUrl(templateUrl, '464x261') }}" />
        {{/image}}
      </div>
      {{/nowAndNext}}
      {{#nowPlaying}}
      <div class="current-programme">
        <p>{{ title }}</p>
        <p>{{ artist }}</p>
      </div>
      {{/nowPlaying}}
    {{/radio.current}}
    {% endraw %}
    </script>

    <script id="servicesTmpl" data-ui-template type="text/ractive">
    {% raw %}
    <ul class="service-list">
    {{#services}}
      <li on-tap="service"
          class="service-item {{ radio.current.id === id ? 'is-playing' : '' }}">
        <a  href="/radio/service/{{ id }}">
          <img src="{{ radio.current.id === id ? logos.active : logos.inactive }}" alt="{{ title }}" />
        </a>
      </li>
    {{/services}}
    </ul>
    {% endraw %}
    </script>

    <script id="mainTmpl" data-ui-template type="text/ractive">
      {% raw %}
        <section id="masthead" class="layout panel">
          {{>mastheadTmpl}}
        </section>

        {{^ui.panels.settings.isOpen}}
        <section id="playout" class="layout panel">
          {{>playoutTmpl}}
        </section>

        <section id="volume" class="layout panel {{ ui.panels.volume.isOpen ? '' : 'is-closed' }}">
          {{>volumeTmpl}}
        </section>

        <section  id="services"
                  class="layout panel services {{ ui.panels.services.isOpen ? '' : 'is-closed' }}">
          {{>servicesTmpl}}
        </section>

        <section id="metadata" class="layout">
          {{>metadataTmpl}}
        </section>

        <section id="behaviours">
          <h2>Magic Button</h2>
          <ul>
            {{#radio.magic}}
              {{#avoider}}
              <li on-tap="avoid">
                {{^isAvoiding}}
                  <a href="/avoider/">Avoider</a>
                {{/isAvoiding}}
                {{#isAvoiding}}
                  <a href="/avoider/">Cancel avoiding</a>
                {{/isAvoiding}}
              </li>
              {{/avoider}}
            {{/radio.magic}}
          </ul>
        </section>
        {{/ui.panels.settings.isOpen}}

        {{#ui.panels.settings.isOpen}}
        <section id="settings">
          <h2>Settings</h2>
          {{#radio.magic.avoider.settings}}
          <div>
            <h2>Avoider</h2>
            Avoid:
              <label><input type='radio' name='{{avoidType}}' value='tracks'> tracks</label>
              <label><input type='radio' name='{{avoidType}}' value='programmes'> programmes</label>
            with:
              <label><input type='radio' name='{{serviceId}}' value='radio1'> Radio 1</label>
              <label><input type='radio' name='{{serviceId}}' value='radio4'> Radio 4</label>
              <label><input type='radio' name='{{serviceId}}' value='6music'> Radio 6 Music</label>
          </div>
          {{/radio.magic.avoider.settings}}
        </section>
        {{/ui.panels.settings.isOpen}}
      {% endraw %}
    </script>

    <div data-ui-container>
    </div>

    <script src="assets/js/app.{% if isDebug %}debug.{% endif %}js"></script>
  </body>
</html>
